
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ENTREGA DEL MINIPROYECTO #1 &#8212; Project Dropout and Academic Success</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=d2032c04" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/styles/bootstrap.css?v=b4a3e8ba" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/styles/theme.css?v=a243ae73" />
    <link rel="stylesheet" type="text/css" href="_static/vendor/fontawesome/6.5.2/css/all.min.css?v=f4fbef65" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'minproyect_1';</script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/copybutton_funcs.js?v=776a791e"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/language_data.js?v=d4673a71"></script>
    <script src="_static/searchtools.js?v=63a53a7d"></script>
    <script src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/bootstrap.js?v=7583a70d"></script>
    <script src="_static/scripts/pydata-sphinx-theme.js?v=4bc35cb3"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?v=4e4fcec4"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Análisis Exploratorio de Datos" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Project Dropout and Academic Success - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Project Dropout and Academic Success - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Análisis Exploratorio de Datos
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">ENTREGA DEL MINIPROYECTO #1</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fminproyect_1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/minproyect_1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ENTREGA DEL MINIPROYECTO #1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indice">Índice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-datos-eda">1. Análisis Exploratorio de Datos (EDA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-los-datos">1.1 Carga de los datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primer-vistazo-a-los-datos">1.2 Primer vistazo a los datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-datos">1.3. Análisis de los datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-las-variables-numericas">1.4 Resumen de las variables numéricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-la-variable-objetivo">1.5 Distribución de la variable objetivo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-las-categoricas-vs-el-target">1.6 Análisis de las categóricas vs el target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-las-variables-numericas">1.7 Visualización de las variables numéricas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histogramas">1.7.1 Histogramas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot-y-deteccion-de-outliers">1.7.2 Boxplot y detección de outliers</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion">1.8 Matriz de correlación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-analisis-exploratorio-de-datos-eda">1.9 Conclusión del Análisis exploratorio de datos (EDA)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-k-nn">2. Modelo K-nn</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-clasificacion-binaria">2.1 Modelo de clasificación binaria</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#busqueda-del-mejor-k">2.1.1 Búsqueda del mejor K</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-del-modelo-con-el-mejor-k-matriz-de-confusion-y-metricas-precision-recall-y-f1-score">2.1.2 Entrenamiento del modelo con el mejor K, matriz de confusión y métricas precision, recall y f1-score</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#curva-roc-y-auc">2.1.3 Curva ROC y AUC</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion">2.2 Modelo de regresión</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.2.1 Búsqueda del mejor K</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-del-modelo-con-el-mejor-k">2.2.2 Entrenamiento del modelo con el mejor k</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-predicho-vs-real">2.2.3 Gráfico predicho vs real</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">3. Conclusiones</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="entrega-del-miniproyecto-1">
<h1>ENTREGA DEL MINIPROYECTO #1<a class="headerlink" href="#entrega-del-miniproyecto-1" title="Link to this heading">#</a></h1>
<p><strong>Desarrollado por</strong>:</p>
<p>Johan Díaz</p>
<p>Miguel Lugo</p>
<p>Luis David Peñaranda</p>
<p>Hector Sanjuan</p>
<section id="indice">
<h2>Índice<a class="headerlink" href="#indice" title="Link to this heading">#</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Análisis Exploratorio de Datos (EDA)

    1.1. Carga de los datos 

    1.2 Primer vistazo a los datos

    1.3. Análisis de los datos

    1.4. Resumen de las variables númericas

    1.5 Distribución de la variable objetivo

    1.6 Análisis de las categóricas vs el target

    1.7 Visualización de las variables numéricas

        1.7.1 Histogramas
    
        1.7.2 Boxplot y detección de outliers

    1.8 Matriz de correlación

2. Modelos K-nn

    2.1 Modelo de clasificación binaria
        
        2.1.1 Búsqueda del mejor K

        2.1.2 Entrenamiento del modelo con el mejor K, matriz de confusión y métricas precision, recall y f1-score

        2.1.3 Curva ROC y AUC

    2.2 Modelo de regresión

        2.2.1 Búsqueda del mejor K

        2.2.2 Entrenamiento del modelo con el mejor k

        2.2.3 Gráfico predicho vs real

3. Conclusiones
</pre></div>
</div>
</section>
<section id="analisis-exploratorio-de-datos-eda">
<h2>1. Análisis Exploratorio de Datos (EDA)<a class="headerlink" href="#analisis-exploratorio-de-datos-eda" title="Link to this heading">#</a></h2>
<section id="carga-de-los-datos">
<h3>1.1 Carga de los datos<a class="headerlink" href="#carga-de-los-datos" title="Link to this heading">#</a></h3>
<p>Primero que todo, cargamos la base de datos almacenada en un archivo <code class="docutils literal notranslate"><span class="pre">.csv</span></code> para poder trabajar con ella.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importación de librerías necesarias</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">display</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats.mstats</span><span class="w"> </span><span class="kn">import</span> <span class="n">winsorize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Visualización</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Configuración de estilo</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)})</span>

<span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/hector3910/minproyect_1/refs/heads/main/data/data.csv&quot;</span>
<span class="c1"># Cargar el archivo CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
<section id="primer-vistazo-a-los-datos">
<h3>1.2 Primer vistazo a los datos<a class="headerlink" href="#primer-vistazo-a-los-datos" title="Link to this heading">#</a></h3>
<p>Para poder realizar un buen modelo tenemos que ver antes el comportamiento de los datos y realizar cambios a los mismos de ser necesarios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar forma del dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El dataset tiene </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> filas y </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnas.&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar primeras filas</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El dataset tiene 4424 filas y 37 columnas.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Marital status</th>
      <th>Application mode</th>
      <th>Application order</th>
      <th>Course</th>
      <th>Daytime/evening attendance\t</th>
      <th>Previous qualification</th>
      <th>Previous qualification (grade)</th>
      <th>Nacionality</th>
      <th>Mother's qualification</th>
      <th>Father's qualification</th>
      <th>...</th>
      <th>Curricular units 2nd sem (credited)</th>
      <th>Curricular units 2nd sem (enrolled)</th>
      <th>Curricular units 2nd sem (evaluations)</th>
      <th>Curricular units 2nd sem (approved)</th>
      <th>Curricular units 2nd sem (grade)</th>
      <th>Curricular units 2nd sem (without evaluations)</th>
      <th>Unemployment rate</th>
      <th>Inflation rate</th>
      <th>GDP</th>
      <th>Target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>17</td>
      <td>5</td>
      <td>171</td>
      <td>1</td>
      <td>1</td>
      <td>122.0</td>
      <td>1</td>
      <td>19</td>
      <td>12</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>10.8</td>
      <td>1.4</td>
      <td>1.74</td>
      <td>Dropout</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>15</td>
      <td>1</td>
      <td>9254</td>
      <td>1</td>
      <td>1</td>
      <td>160.0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>13.666667</td>
      <td>0</td>
      <td>13.9</td>
      <td>-0.3</td>
      <td>0.79</td>
      <td>Graduate</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>9070</td>
      <td>1</td>
      <td>1</td>
      <td>122.0</td>
      <td>1</td>
      <td>37</td>
      <td>37</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>10.8</td>
      <td>1.4</td>
      <td>1.74</td>
      <td>Dropout</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>17</td>
      <td>2</td>
      <td>9773</td>
      <td>1</td>
      <td>1</td>
      <td>122.0</td>
      <td>1</td>
      <td>38</td>
      <td>37</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>10</td>
      <td>5</td>
      <td>12.400000</td>
      <td>0</td>
      <td>9.4</td>
      <td>-0.8</td>
      <td>-3.12</td>
      <td>Graduate</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>39</td>
      <td>1</td>
      <td>8014</td>
      <td>0</td>
      <td>1</td>
      <td>100.0</td>
      <td>1</td>
      <td>37</td>
      <td>38</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>13.000000</td>
      <td>0</td>
      <td>13.9</td>
      <td>-0.3</td>
      <td>0.79</td>
      <td>Graduate</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
</section>
<section id="analisis-de-los-datos">
<h3>1.3. Análisis de los datos<a class="headerlink" href="#analisis-de-los-datos" title="Link to this heading">#</a></h3>
<p>Revisamos las características de la base de datos, y si hay datos faltantes en la base aplicamos una imputación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resumen técnico del DataFrame:&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resumen técnico del DataFrame:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4424 entries, 0 to 4423
Data columns (total 37 columns):
 #   Column                                          Non-Null Count  Dtype  
---  ------                                          --------------  -----  
 0   Marital status                                  4424 non-null   int64  
 1   Application mode                                4424 non-null   int64  
 2   Application order                               4424 non-null   int64  
 3   Course                                          4424 non-null   int64  
 4   Daytime/evening attendance	                     4424 non-null   int64  
 5   Previous qualification                          4424 non-null   int64  
 6   Previous qualification (grade)                  4424 non-null   float64
 7   Nacionality                                     4424 non-null   int64  
 8   Mother&#39;s qualification                          4424 non-null   int64  
 9   Father&#39;s qualification                          4424 non-null   int64  
 10  Mother&#39;s occupation                             4424 non-null   int64  
 11  Father&#39;s occupation                             4424 non-null   int64  
 12  Admission grade                                 4424 non-null   float64
 13  Displaced                                       4424 non-null   int64  
 14  Educational special needs                       4424 non-null   int64  
 15  Debtor                                          4424 non-null   int64  
 16  Tuition fees up to date                         4424 non-null   int64  
 17  Gender                                          4424 non-null   int64  
 18  Scholarship holder                              4424 non-null   int64  
 19  Age at enrollment                               4424 non-null   int64  
 20  International                                   4424 non-null   int64  
 21  Curricular units 1st sem (credited)             4424 non-null   int64  
 22  Curricular units 1st sem (enrolled)             4424 non-null   int64  
 23  Curricular units 1st sem (evaluations)          4424 non-null   int64  
 24  Curricular units 1st sem (approved)             4424 non-null   int64  
 25  Curricular units 1st sem (grade)                4424 non-null   float64
 26  Curricular units 1st sem (without evaluations)  4424 non-null   int64  
 27  Curricular units 2nd sem (credited)             4424 non-null   int64  
 28  Curricular units 2nd sem (enrolled)             4424 non-null   int64  
 29  Curricular units 2nd sem (evaluations)          4424 non-null   int64  
 30  Curricular units 2nd sem (approved)             4424 non-null   int64  
 31  Curricular units 2nd sem (grade)                4424 non-null   float64
 32  Curricular units 2nd sem (without evaluations)  4424 non-null   int64  
 33  Unemployment rate                               4424 non-null   float64
 34  Inflation rate                                  4424 non-null   float64
 35  GDP                                             4424 non-null   float64
 36  Target                                          4424 non-null   object 
dtypes: float64(7), int64(29), object(1)
memory usage: 1.2+ MB
</pre></div>
</div>
</div>
</div>
<p>La función <code class="docutils literal notranslate"><span class="pre">.info()</span></code> nos revela lo siguiente:</p>
<ul class="simple">
<li><p><strong>El tamaño de la base de datos:</strong> Este conjunto de datos tiene 4424 entradas, así como 37 columnas, incluyendo el target.</p></li>
<li><p><strong>Los tipos de datos encontrados</strong>: Si bien a simple vista podemos apreciar que algunos nombres de las variables nos indican que estas deberían ser categóricas, en esta base de datos se encuentran registradas por una codificación numérica, por lo que aparecen como tipo <code class="docutils literal notranslate"><span class="pre">int64</span></code>. Otros tipos encontrados son el <code class="docutils literal notranslate"><span class="pre">float64</span></code> para variables como <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code>, el cual se refiere a la nota conseguida por los alumnos. Por último, está el tipo <code class="docutils literal notranslate"><span class="pre">object</span></code> para la variable target, la cual si está registrada por sus categorías y no por una codificación.</p></li>
<li><p><strong>El número de valores no nulos por variable</strong>: Dado que, en cada variable, el número de valores no nulos es el mismo que el de instancias de la base de datos, concluimos que no existen datos faltantes, por lo que podemos seguir con el análisis sin necesidad de una imputación.</p></li>
</ul>
<p>Dado que las variables categóricas están codificadas numéricamente, vamos a diferenciarlas de las númericas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Limpiamos los nombres de las columnas</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1">#Variables categóricas codificadas numéricamente</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Marital status&#39;</span><span class="p">,</span> <span class="s1">&#39;Application mode&#39;</span><span class="p">,</span> <span class="s1">&#39;Application order&#39;</span><span class="p">,</span> <span class="s1">&#39;Course&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Daytime/evening attendance&#39;</span><span class="p">,</span> <span class="s1">&#39;Previous qualification&#39;</span><span class="p">,</span> <span class="s1">&#39;Nacionality&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Mother&#39;s qualification&quot;</span><span class="p">,</span> <span class="s2">&quot;Father&#39;s qualification&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Mother&#39;s occupation&quot;</span><span class="p">,</span> <span class="s2">&quot;Father&#39;s occupation&quot;</span><span class="p">,</span> <span class="s1">&#39;Displaced&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Educational special needs&#39;</span><span class="p">,</span> <span class="s1">&#39;Debtor&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuition fees up to date&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Scholarship holder&#39;</span><span class="p">,</span> <span class="s1">&#39;International&#39;</span>
<span class="p">]</span>

<span class="c1">#Seleccionar variables numéricas reales</span>
<span class="n">numerical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> 
                     <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">]</span> 
                     <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical_columns</span> 
                     <span class="ow">and</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;Target&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="resumen-de-las-variables-numericas">
<h3>1.4 Resumen de las variables numéricas<a class="headerlink" href="#resumen-de-las-variables-numericas" title="Link to this heading">#</a></h3>
<p>Realizamos un resumen numérico de la base de datos con la función <code class="docutils literal notranslate"><span class="pre">describe()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Medidas estadísticas para variables numéricas reales</span>
<span class="n">medidas</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">medidas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Previous qualification (grade)</th>
      <td>4424.0</td>
      <td>132.613314</td>
      <td>13.188332</td>
      <td>95.00</td>
      <td>125.00</td>
      <td>133.100000</td>
      <td>140.000000</td>
      <td>190.000000</td>
    </tr>
    <tr>
      <th>Admission grade</th>
      <td>4424.0</td>
      <td>126.978119</td>
      <td>14.482001</td>
      <td>95.00</td>
      <td>117.90</td>
      <td>126.100000</td>
      <td>134.800000</td>
      <td>190.000000</td>
    </tr>
    <tr>
      <th>Age at enrollment</th>
      <td>4424.0</td>
      <td>23.265145</td>
      <td>7.587816</td>
      <td>17.00</td>
      <td>19.00</td>
      <td>20.000000</td>
      <td>25.000000</td>
      <td>70.000000</td>
    </tr>
    <tr>
      <th>Curricular units 1st sem (credited)</th>
      <td>4424.0</td>
      <td>0.709991</td>
      <td>2.360507</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>Curricular units 1st sem (enrolled)</th>
      <td>4424.0</td>
      <td>6.270570</td>
      <td>2.480178</td>
      <td>0.00</td>
      <td>5.00</td>
      <td>6.000000</td>
      <td>7.000000</td>
      <td>26.000000</td>
    </tr>
    <tr>
      <th>Curricular units 1st sem (evaluations)</th>
      <td>4424.0</td>
      <td>8.299051</td>
      <td>4.179106</td>
      <td>0.00</td>
      <td>6.00</td>
      <td>8.000000</td>
      <td>10.000000</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>Curricular units 1st sem (approved)</th>
      <td>4424.0</td>
      <td>4.706600</td>
      <td>3.094238</td>
      <td>0.00</td>
      <td>3.00</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>26.000000</td>
    </tr>
    <tr>
      <th>Curricular units 1st sem (grade)</th>
      <td>4424.0</td>
      <td>10.640822</td>
      <td>4.843663</td>
      <td>0.00</td>
      <td>11.00</td>
      <td>12.285714</td>
      <td>13.400000</td>
      <td>18.875000</td>
    </tr>
    <tr>
      <th>Curricular units 1st sem (without evaluations)</th>
      <td>4424.0</td>
      <td>0.137658</td>
      <td>0.690880</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>Curricular units 2nd sem (credited)</th>
      <td>4424.0</td>
      <td>0.541817</td>
      <td>1.918546</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>Curricular units 2nd sem (enrolled)</th>
      <td>4424.0</td>
      <td>6.232143</td>
      <td>2.195951</td>
      <td>0.00</td>
      <td>5.00</td>
      <td>6.000000</td>
      <td>7.000000</td>
      <td>23.000000</td>
    </tr>
    <tr>
      <th>Curricular units 2nd sem (evaluations)</th>
      <td>4424.0</td>
      <td>8.063291</td>
      <td>3.947951</td>
      <td>0.00</td>
      <td>6.00</td>
      <td>8.000000</td>
      <td>10.000000</td>
      <td>33.000000</td>
    </tr>
    <tr>
      <th>Curricular units 2nd sem (approved)</th>
      <td>4424.0</td>
      <td>4.435805</td>
      <td>3.014764</td>
      <td>0.00</td>
      <td>2.00</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>Curricular units 2nd sem (grade)</th>
      <td>4424.0</td>
      <td>10.230206</td>
      <td>5.210808</td>
      <td>0.00</td>
      <td>10.75</td>
      <td>12.200000</td>
      <td>13.333333</td>
      <td>18.571429</td>
    </tr>
    <tr>
      <th>Curricular units 2nd sem (without evaluations)</th>
      <td>4424.0</td>
      <td>0.150316</td>
      <td>0.753774</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>Unemployment rate</th>
      <td>4424.0</td>
      <td>11.566139</td>
      <td>2.663850</td>
      <td>7.60</td>
      <td>9.40</td>
      <td>11.100000</td>
      <td>13.900000</td>
      <td>16.200000</td>
    </tr>
    <tr>
      <th>Inflation rate</th>
      <td>4424.0</td>
      <td>1.228029</td>
      <td>1.382711</td>
      <td>-0.80</td>
      <td>0.30</td>
      <td>1.400000</td>
      <td>2.600000</td>
      <td>3.700000</td>
    </tr>
    <tr>
      <th>GDP</th>
      <td>4424.0</td>
      <td>0.001969</td>
      <td>2.269935</td>
      <td>-4.06</td>
      <td>-1.70</td>
      <td>0.320000</td>
      <td>1.790000</td>
      <td>3.510000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A simple vista, y como posteriormente veremos en los boxplot, podemos ver algunas cosas interesantes.</p>
<ul class="simple">
<li><p>En las variables que hacen referencia a las asignaturas homologadas por el estudiante, es decir: <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>, el 75% de los datos está registrado como 0, pero el registro mas alto es 20 y 19 respectivamente. Esto tiene sentido, ya que no todos los estudiantes tienen la oportunidad de homologar materias, por lo que la gran mayoría tiene un valor de 0 en ese registro. Esto ademas nos da un indicio de que existen valores atípicos en estas variables.</p></li>
<li><p>El comportamiento recién mencionado se puede apreciar también en las variables que hacen referencia a las asignaturas en las que los estudiantes no fueron evaluados (<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluations)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluations)</span></code>). Esto nos indica que no es tan grande la cantidad de alumnos que no presentaron exámenes (por abandonar la materia o por no cumplir los requisitos de la evaluación).</p></li>
<li><p>El valor mínimo de las variables que reflejan la nota de los estudiantes (<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code>) es de 0, la cual puede ser una de las mas importantes razones por la cual un estudiante decida abandonar la universidad.</p></li>
</ul>
</section>
<section id="distribucion-de-la-variable-objetivo">
<h3>1.5 Distribución de la variable objetivo<a class="headerlink" href="#distribucion-de-la-variable-objetivo" title="Link to this heading">#</a></h3>
<p>Luego del resumen numérico, veamos entonces como se encuentra distribuida la variable objetivo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir la variable Target a tipo categórico</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

<span class="c1"># Ver distribución de clases</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribución de la variable objetivo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1"># Visualizar la distribución</span>
<span class="n">ax</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de la variable objetivo (Target)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Categoría&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">percentage</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">percentage</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribución de la variable objetivo:
Target
Graduate    2209
Dropout     1421
Enrolled     794
Name: count, dtype: int64
</pre></div>
</div>
<img alt="_images/00ed4ec05427a854c152adc5e03c4283835e66a7480043a92c9cfee13028b4ce.png" src="_images/00ed4ec05427a854c152adc5e03c4283835e66a7480043a92c9cfee13028b4ce.png" />
</div>
</div>
<p>Podemos apreciar que la variable objetivo tiene 3 clases:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dropout</span></code>: Estudiante que abandonó la universidad</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Enrolled</span></code>: Estudiante que sigue en la universidad</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Graduate</span></code>: Estudiante graduado de la universidad</p></li>
</ul>
<p>Además, se ve un claro desbalance de los datos en esta variable.</p>
<p>Dado que nuestro objetivo final es predecir qué estudiantes van a abandonar la universidad, podemos resumir el problema en uno de clasificación binaria, tomando los registros de las clases <code class="docutils literal notranslate"><span class="pre">Enrolled</span></code> y <code class="docutils literal notranslate"><span class="pre">Graduate</span></code> como uno solo llamado <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">Dropout</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
    <span class="s1">&#39;Dropout&#39;</span><span class="p">:</span> <span class="s2">&quot;Dropout&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Enrolled&#39;</span><span class="p">:</span> <span class="s2">&quot;Not Dropout&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Graduate&#39;</span><span class="p">:</span> <span class="s2">&quot;Not Dropout&quot;</span>
<span class="p">})</span>

<span class="c1"># Verificamos la codificación</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Target
Not Dropout    3003
Dropout        1421
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Volvemos a visualizar la distribución</span>
<span class="n">ax</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de la variable objetivo (Target)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Categoría&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">percentage</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">percentage</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1da6e8e7253f6e0dfd365ea0ce0490417b7fd4135a5d063317608701f028c816.png" src="_images/1da6e8e7253f6e0dfd365ea0ce0490417b7fd4135a5d063317608701f028c816.png" />
</div>
</div>
<p>Ahora, sabiendo que el <code class="docutils literal notranslate"><span class="pre">67.9%</span></code> de los registros corresponden a los estudiantes que no abandonaron, y que el <code class="docutils literal notranslate"><span class="pre">32.1%</span></code> a los que sí, nos damos cuenta una vez más del desbalance con el que cuentan los datos.</p>
</section>
<section id="analisis-de-las-categoricas-vs-el-target">
<h3>1.6 Análisis de las categóricas vs el target<a class="headerlink" href="#analisis-de-las-categoricas-vs-el-target" title="Link to this heading">#</a></h3>
<p>Veamos como se comportan las variables categóricas dependiendo de si el estudiante abandonó o no.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar todos los gráficos de barras en una sola imagen (subplots)</span>


<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Número de columnas de subplots (ajusta según prefieras)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">cols</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cols</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> vs Target&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>

<span class="c1"># Eliminar subplots vacíos si hay</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2a93cd223894db14e4f65c580a3efc542ea48ddc0374916ac7090d7d4a9591f6.png" src="_images/2a93cd223894db14e4f65c580a3efc542ea48ddc0374916ac7090d7d4a9591f6.png" />
</div>
</div>
<p>De estos gráficos podemos concluir varias cosas:</p>
<ul class="simple">
<li><p>En la variable <code class="docutils literal notranslate"><span class="pre">Marital</span> <span class="pre">Status</span></code>, las categorías mas influyentes son: soltero<code class="docutils literal notranslate"><span class="pre">(1)</span></code> y casado<code class="docutils literal notranslate"><span class="pre">(2)</span></code>. Aún teniendo en cuenta que hay un desbalance en la clases del target, la proporción de abandono de los estudiantes casados es bastante alta.</p></li>
<li><p>De la variable <code class="docutils literal notranslate"><span class="pre">Course</span></code> observamos que, a excepción de unos cuantos cursos, la proporción de abandono es relativamente baja.</p></li>
<li><p>De la variable <code class="docutils literal notranslate"><span class="pre">Gender</span></code>, la proporción de hombres <code class="docutils literal notranslate"><span class="pre">(1)</span></code> que abandonan los estudios es muy alta, mientras que la de mujeres <code class="docutils literal notranslate"><span class="pre">(0)</span></code> no tanto.</p></li>
</ul>
</section>
<section id="visualizacion-de-las-variables-numericas">
<h3>1.7 Visualización de las variables numéricas<a class="headerlink" href="#visualizacion-de-las-variables-numericas" title="Link to this heading">#</a></h3>
<section id="histogramas">
<h4>1.7.1 Histogramas<a class="headerlink" href="#histogramas" title="Link to this heading">#</a></h4>
<p>Primero, veamos cómo se distribuyen las variables numéricas por medio de histogramas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualización de histogramas</span>
<span class="n">df</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Histogramas de variables numéricas&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/397970110ee44a81625c5eb6d2b959618d67526f3857002db3c8dca7772acea3.png" src="_images/397970110ee44a81625c5eb6d2b959618d67526f3857002db3c8dca7772acea3.png" />
</div>
</div>
<p>De estos histogramas notamos varias cosas:</p>
<ul class="simple">
<li><p>Solo la variable <code class="docutils literal notranslate"><span class="pre">Previous</span> <span class="pre">qualification</span> <span class="pre">(grade)</span></code> parece tener distribución normal.</p></li>
<li><p>Como se anticipó en el resumen numérico, la gran mayoría de los registros de las variables :<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluation)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluation)</span></code>, giran en torno a 0, debido a que no es tan común que muchos estudiantes homologuen asignaturas o no se presenten a las evaluaciones correspondientes.</p></li>
<li><p>Variables como <code class="docutils literal notranslate"><span class="pre">Admission</span> <span class="pre">grade</span></code> , <code class="docutils literal notranslate"><span class="pre">Age</span> <span class="pre">at</span> <span class="pre">enrollment</span></code>, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(enrolled)</span></code>,<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(evaluations)</span></code>,<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluations)</span></code>,<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>,<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(enrolled)</span></code>,<code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(evaluations)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluations)</span></code> tienen un sesgo a la derecha.</p></li>
</ul>
</section>
<section id="boxplot-y-deteccion-de-outliers">
<h4>1.7.2 Boxplot y detección de outliers<a class="headerlink" href="#boxplot-y-deteccion-de-outliers" title="Link to this heading">#</a></h4>
<p>En esta sección veremos otra forma de ver la distribución de los datos y la cantidad de outliers que tienen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualización: boxplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Boxplots de variables numéricas&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/31c91bc0ee8ad9a99dae11d5fbe8b1c396bcf87ba4d1536b848c3a934c6ac368.png" src="_images/31c91bc0ee8ad9a99dae11d5fbe8b1c396bcf87ba4d1536b848c3a934c6ac368.png" />
</div>
</div>
<p>De estas gráficas podemos notar que:</p>
<ul class="simple">
<li><p>Las variables <code class="docutils literal notranslate"><span class="pre">Unemployment</span> <span class="pre">rate</span></code>, <code class="docutils literal notranslate"><span class="pre">Inflation</span> <span class="pre">rate</span></code> y <code class="docutils literal notranslate"><span class="pre">GDP</span></code> son las únicas que no tienen outliers.</p></li>
<li><p>Variables que representan notas como lo son: <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code>y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code> tienen valores atípicos no tan dispersos, esto se debe a que de por sí la caja es bastante compacta y son muy pocas las notas casi perfectas o notas que demuestran la inasistencia al curso como lo es el 0.</p></li>
<li><p>Variables como <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(credited)</span></code>, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluations)</span></code>y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(without</span> <span class="pre">evaluations)</span></code> tienen valores atípicos muy dispersos, lo cual encaja con la descripción vista en la sección anterior.</p></li>
</ul>
<p>Ahora veamos una comparación con boxplots entre el grupo que abandonó y el que no lo hizo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numerical_columns</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>  
<span class="n">rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">cols</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cols</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_columns</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> vs Target&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="c1"># Eliminar subplots vacíos si hay</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Boxplots de variables numéricas por Target&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8149355ce2af328660ad07439e998f4b8ace8d69ea57cad8bf3f4a1681b5ec1a.png" src="_images/8149355ce2af328660ad07439e998f4b8ace8d69ea57cad8bf3f4a1681b5ec1a.png" />
</div>
</div>
<p>Aquí podemos ver varias diferencias bastante marcadas:</p>
<ul class="simple">
<li><p>Como era de esperarse, y como se puede apreciar en los diagramas de las variables asociadas a las notas de cada semestre, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code>, las personas con las nostas más bajas son las que tienden a retirarse de la universidad.</p></li>
<li><p>Así mismo, las personas que ganan una mayor cantidad de materias en cada semestre, vea <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(approved)</span></code>  y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2nd</span> <span class="pre">sem</span> <span class="pre">(approved)</span></code>, son las que tienden a quedarse estudiando.</p></li>
<li><p>Los otros boxplots no muestran una relación tan directa como los ya mencionados.</p></li>
</ul>
<p>En general, prácticamente todas las variables tienen valores atípicos, y esto no necesariamente debe significar que son registros erróneos, sino que al estar evaluando a tantas personas, siempre está la posibilidad de que algunos destaquen sobre el resto, ya sea en sus notas, favorable o desfavorablemente, en el número de materias inscritas, en el número de materias homologadas, etc. Por ello, vamos a ver la cantidad de outliers que hay por variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función para detectar outliers usando IQR</span>
<span class="k">def</span><span class="w"> </span><span class="nf">detectar_outliers_iqr</span><span class="p">(</span><span class="n">serie</span><span class="p">):</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">serie</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">Q3</span> <span class="o">=</span> <span class="n">serie</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">serie</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">serie</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">))</span>

<span class="c1"># Contar outliers por variable</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conteo de outliers por variable numérica:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numerical_columns</span><span class="p">:</span>
    <span class="n">outliers</span> <span class="o">=</span> <span class="n">detectar_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">outliers</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2"> outliers detectados&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conteo de outliers por variable numérica:
Previous qualification (grade): 179 outliers detectados
Admission grade: 86 outliers detectados
Age at enrollment: 441 outliers detectados
Curricular units 1st sem (credited): 577 outliers detectados
Curricular units 1st sem (enrolled): 424 outliers detectados
Curricular units 1st sem (evaluations): 158 outliers detectados
Curricular units 1st sem (approved): 180 outliers detectados
Curricular units 1st sem (grade): 726 outliers detectados
Curricular units 1st sem (without evaluations): 294 outliers detectados
Curricular units 2nd sem (credited): 530 outliers detectados
Curricular units 2nd sem (enrolled): 369 outliers detectados
Curricular units 2nd sem (evaluations): 109 outliers detectados
Curricular units 2nd sem (approved): 44 outliers detectados
Curricular units 2nd sem (grade): 877 outliers detectados
Curricular units 2nd sem (without evaluations): 282 outliers detectados
Unemployment rate: 0 outliers detectados
Inflation rate: 0 outliers detectados
GDP: 0 outliers detectados
</pre></div>
</div>
</div>
</div>
<p>Como vemos, hay bastantes outliers, esto más que nada se debe a que, al ser registros de notas de diferentes alumnos, hay bastantes que se destacan por encima del resto, por lo que pueden ser marcados como outliers.</p>
</section>
</section>
<section id="matriz-de-correlacion">
<h3>1.8 Matriz de correlación<a class="headerlink" href="#matriz-de-correlacion" title="Link to this heading">#</a></h3>
<p>Veamos ahora la matriz de correlación para las variables numéricas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matriz de correlación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de correlación de variables numéricas&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04e71d9b29861ade980b7be358d1495d4e472ae594a3cca05c9ff901901a6430.png" src="_images/04e71d9b29861ade980b7be358d1495d4e472ae594a3cca05c9ff901901a6430.png" />
</div>
</div>
<p>Veamos cuales son las variables que mas se relacionan entre sí:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Previous</span> <span class="pre">qualification</span> <span class="pre">(grade)</span></code>y <code class="docutils literal notranslate"><span class="pre">Admission</span> <span class="pre">grade</span></code>: Por su misma definición, tiene sentido que estén algo relacionadas, ya que ambas notas son de antes de entrar a la universidad, así que sus notas puede que no varíen tanto de un momento a otro, lo cual es confimado por la matriz</p></li>
<li><p>En general podemos ver una gran correlación entre las materias aprobadas de cada semestre, las notas conseguidas de cada semestre y las materias matriculadas en cada semestre, lo cual indica un desempeño similar para los estudiantes en los dos semestres.</p></li>
</ul>
</section>
<section id="conclusion-del-analisis-exploratorio-de-datos-eda">
<h3>1.9 Conclusión del Análisis exploratorio de datos (EDA)<a class="headerlink" href="#conclusion-del-analisis-exploratorio-de-datos-eda" title="Link to this heading">#</a></h3>
<p>Gracias a este análisis exploratorio, podemos darnos mejores ideas de como se comportan los datos:</p>
<ul class="simple">
<li><p>Nos brindó el hecho de que <strong>no hay datos faltantes</strong>, lo cual evita que hagamos una imputación innecesaria de datos.</p></li>
<li><p>A su vez pudimos confirmar que variables como las notas conseguidas en los 2 semestres, <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">1st</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code> y <code class="docutils literal notranslate"><span class="pre">Curricular</span> <span class="pre">units</span> <span class="pre">2</span> <span class="pre">sem</span> <span class="pre">(grade)</span></code>, tienen una alta relación con el hecho de que un estudiante abandone o no la universidad.</p></li>
<li><p>Los <strong>outliers</strong>, aunque son muchos, pueden ser tratados con el fin de mejorar el rendimiento del modelo.</p></li>
</ul>
<p>Luego de realizar este análisis exploratorio, podemos empezar a implementar tanto el modelo de clasificación, como el modelo de regresión, para predecir si un estudiante abandonará la universidad o no, y su promedio, respectivamente.</p>
</section>
</section>
<section id="modelo-k-nn">
<h2>2. Modelo K-nn<a class="headerlink" href="#modelo-k-nn" title="Link to this heading">#</a></h2>
<section id="modelo-de-clasificacion-binaria">
<h3>2.1 Modelo de clasificación binaria<a class="headerlink" href="#modelo-de-clasificacion-binaria" title="Link to this heading">#</a></h3>
<p>Primero, vamos a codificar numéricamente la variable objetivo, previamente modificada para atender a un problema de clasificación binaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Codificamos manualmente la variable objetivo &#39;Target&#39; para clasificación binaria</span>
<span class="c1"># 1 → Estudiante que abandonó (Dropout)</span>
<span class="c1"># 0 → Estudiante que sigue activo (Enrolled) o se graduó (Graduate), ambas categorías se consideran como &quot;Not Dropout&quot;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
    <span class="s1">&#39;Dropout&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Not Dropout&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Verificamos la codificación</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Target
0    3003
1    1421
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Luego, separamos las características y la variable objetivo, con el fin de usarla posteriormente para entrenar al modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Separamos las características y la variable objetivo</span>
<span class="c1"># &#39;X&#39; contiene todas las columnas excepto &#39;Target&#39;</span>
<span class="c1"># &#39;y&#39; contiene únicamente la columna objetivo ya codificada (abandona = 1, no abandona = 0)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Verificamos que todo haya salido bien.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar la lista completa de nombres de columnas en X</span>
<span class="c1"># Esto es útil para verificar qué variables están disponibles después de eliminar &#39;Target&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Marital status&#39;, &#39;Application mode&#39;, &#39;Application order&#39;, &#39;Course&#39;, &#39;Daytime/evening attendance&#39;, &#39;Previous qualification&#39;, &#39;Previous qualification (grade)&#39;, &#39;Nacionality&#39;, &quot;Mother&#39;s qualification&quot;, &quot;Father&#39;s qualification&quot;, &quot;Mother&#39;s occupation&quot;, &quot;Father&#39;s occupation&quot;, &#39;Admission grade&#39;, &#39;Displaced&#39;, &#39;Educational special needs&#39;, &#39;Debtor&#39;, &#39;Tuition fees up to date&#39;, &#39;Gender&#39;, &#39;Scholarship holder&#39;, &#39;Age at enrollment&#39;, &#39;International&#39;, &#39;Curricular units 1st sem (credited)&#39;, &#39;Curricular units 1st sem (enrolled)&#39;, &#39;Curricular units 1st sem (evaluations)&#39;, &#39;Curricular units 1st sem (approved)&#39;, &#39;Curricular units 1st sem (grade)&#39;, &#39;Curricular units 1st sem (without evaluations)&#39;, &#39;Curricular units 2nd sem (credited)&#39;, &#39;Curricular units 2nd sem (enrolled)&#39;, &#39;Curricular units 2nd sem (evaluations)&#39;, &#39;Curricular units 2nd sem (approved)&#39;, &#39;Curricular units 2nd sem (grade)&#39;, &#39;Curricular units 2nd sem (without evaluations)&#39;, &#39;Unemployment rate&#39;, &#39;Inflation rate&#39;, &#39;GDP&#39;]
</pre></div>
</div>
</div>
</div>
<p>Dado que todo fue separado correctamente, procedemos a importar las librerias necesarias para el modelo K-nn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StratifiedKFold</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">precision_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
</pre></div>
</div>
</div>
</div>
<section id="busqueda-del-mejor-k">
<h4>2.1.1 Búsqueda del mejor K<a class="headerlink" href="#busqueda-del-mejor-k" title="Link to this heading">#</a></h4>
<p>Primero que todo, queremos encontrar el número de vecinos óptimo para encontrar el modelo de mejor rendimiento, para esto, primero dividimos el conjunto de datos con la función <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code>, dejando un conjunto de test para la evaluación del modelo, esto con el fin de que la selección del mejor parámetro k no interfiera en el resultado del entrenamiento. Luego, mediante validación cruzada manual, dividimos nuevamente el conjunto de entrenamiento y entrenamos los modelos con cada número de k vecinos, desde el 1 hasta el 20, y luego guardamos en una lista los scores conseguidos por accuracy en el entrenamiento y la validación, y los scores de precision, recall y f1-score.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar variables numéricas reales</span>
<span class="n">numerical_columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">)</span>
<span class="c1"># ====== DIVISIÓN INICIAL: train+val y test ======</span>
<span class="n">X_trainval</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="c1"># ====== VALIDACIÓN CRUZADA MANUAL EN trainval ======</span>
<span class="n">resultados_k</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="n">accuracy_val_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">precision_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recall_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f1_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># 5-fold split manual usando train_test_split en cada fold</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
            <span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span>  <span class="n">stratify</span><span class="o">=</span><span class="n">y_trainval</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span>
        <span class="p">)</span>

        <span class="c1"># One-hot encoding por fold</span>
        <span class="n">X_train_enc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">X_val_enc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">X_train_enc</span><span class="p">,</span> <span class="n">X_val_enc</span> <span class="o">=</span> <span class="n">X_train_enc</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">X_val_enc</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Escalado solo numérico</span>
        <span class="n">num_cols_to_scale</span> <span class="o">=</span> <span class="n">numerical_columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X_train_enc</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
        <span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">X_train_enc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">X_val_scaled</span> <span class="o">=</span> <span class="n">X_val_enc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">X_train_scaled</span><span class="p">[</span><span class="n">num_cols_to_scale</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_enc</span><span class="p">[</span><span class="n">num_cols_to_scale</span><span class="p">])</span>
        <span class="n">X_val_scaled</span><span class="p">[</span><span class="n">num_cols_to_scale</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val_enc</span><span class="p">[</span><span class="n">num_cols_to_scale</span><span class="p">])</span>

        <span class="c1"># Convertir a arrays</span>
        <span class="n">X_train_final</span> <span class="o">=</span> <span class="n">X_train_scaled</span><span class="o">.</span><span class="n">values</span>
        <span class="n">X_val_final</span> <span class="o">=</span> <span class="n">X_val_scaled</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Modelo</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_final</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># Predicciones</span>
        <span class="n">y_pred_val</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_final</span><span class="p">)</span>
        <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_final</span><span class="p">)</span>

        <span class="c1"># Métricas</span>
        <span class="n">accuracy_val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred_val</span><span class="p">))</span>
        <span class="n">precision_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred_val</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">recall_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred_val</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">f1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred_val</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Guardar resultados de este k</span>
    <span class="n">resultados_k</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span>
        <span class="s1">&#39;Accuracy_val&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy_val_list</span><span class="p">),</span>
        <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">precision_list</span><span class="p">),</span>
        <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recall_list</span><span class="p">),</span>
        <span class="s1">&#39;F1-score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f1_list</span><span class="p">)</span>
    <span class="p">})</span>

<span class="c1"># Convertir a DataFrame</span>
<span class="n">df_resultados_original</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_k</span><span class="p">)</span>
<span class="n">df_resultados_original</span><span class="p">[</span><span class="s1">&#39;Observaciones&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">)</span>
<span class="n">df_resultados_original</span><span class="p">[</span><span class="s1">&#39;Dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Original&#39;</span>

<span class="c1"># Mantén ambas columnas para la gráfica Train vs Val</span>
<span class="n">df_resultados_original</span> <span class="o">=</span> <span class="n">df_resultados_original</span><span class="p">[[</span>
    <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;Accuracy_val&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;F1-score&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Observaciones&#39;</span><span class="p">,</span> <span class="s1">&#39;Dataset&#39;</span>
<span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Métricas promedio por valor de k (5-fold CV manual):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados_original</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Métricas promedio por valor de k (5-fold CV manual):
     k  Accuracy_val  Precision  Recall  F1-score  Observaciones   Dataset
0    1        0.7930     0.7060  0.6120    0.6553           3318  Original
1    2        0.8118     0.8975  0.4682    0.6150           3318  Original
2    3        0.8227     0.8145  0.5813    0.6780           3318  Original
3    4        0.8159     0.8791  0.4959    0.6339           3318  Original
4    5        0.8234     0.8284  0.5693    0.6743           3318  Original
5    6        0.8154     0.8776  0.4959    0.6333           3318  Original
6    7        0.8229     0.8461  0.5498    0.6662           3318  Original
7    8        0.8212     0.8900  0.5071    0.6457           3318  Original
8    9        0.8227     0.8615  0.5348    0.6596           3318  Original
9   10        0.8210     0.8928  0.5041    0.6441           3318  Original
10  11        0.8234     0.8746  0.5266    0.6571           3318  Original
11  12        0.8224     0.9036  0.5019    0.6449           3318  Original
12  13        0.8267     0.8956  0.5228    0.6598           3318  Original
13  14        0.8224     0.9122  0.4959    0.6420           3318  Original
14  15        0.8251     0.8948  0.5169    0.6551           3318  Original
15  16        0.8198     0.9108  0.4876    0.6347           3318  Original
16  17        0.8236     0.9037  0.5056    0.6481           3318  Original
17  18        0.8169     0.9164  0.4742    0.6245           3318  Original
18  19        0.8205     0.9122  0.4891    0.6364           3318  Original
19  20        0.8169     0.9226  0.4704    0.6228           3318  Original
</pre></div>
</div>
</div>
</div>
<p>Cabe aclarar una cosa muy importante que no ha sido mencionada a lo largo de este proyecto: la estandarización y codificación de las variables númericas y categóricas respectivamente.</p>
<p>Decidimos realizar estos procesos luego de dividir el conjunto de entrenamiento por segunda ocasión ya que esto evita el <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">leakage</span></code>, por lo que el preprocesamiento de datos se realizará luego de cada división de los mismos en cada entrenamiento de un modelo.</p>
<p>Ahora, luego de conseguir los scores para cada k, veamos gráficamente que tal se comportan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegura orden por k</span>
<span class="n">orig</span> <span class="o">=</span> <span class="n">df_resultados_original</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">orig</span><span class="p">[</span><span class="s1">&#39;Accuracy_val&#39;</span><span class="p">],</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accuracy (Val)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">orig</span><span class="p">[</span><span class="s1">&#39;Precision&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Precision&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">orig</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">],</span>    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Recall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">orig</span><span class="p">[</span><span class="s1">&#39;F1-score&#39;</span><span class="p">],</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F1-score&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Métricas de Validación Cruzada por valor de k — Dataset Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Número de vecinos (k)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la métrica&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ffe6b25b4d77400d96a6da6735e902057e74868dec7a672fecce78d4c861c5f5.png" src="_images/ffe6b25b4d77400d96a6da6735e902057e74868dec7a672fecce78d4c861c5f5.png" />
</div>
</div>
<p>Gracias a este gráfico nos podemos dar cuenta de como va cambiando el rendimiento del modelo a medida que cambiamos la k. Para escoger al mejor k, decidimos usar la métrica f1-score, ya que nos parece mejor para definir el objetivo del modelo el cual es ver los alumnos que abandonaron la universidad, ya que tanto un falso positivo como un falso negativo nos parece igual de grave para la generalización del modelo.</p>
</section>
<section id="entrenamiento-del-modelo-con-el-mejor-k-matriz-de-confusion-y-metricas-precision-recall-y-f1-score">
<h4>2.1.2 Entrenamiento del modelo con el mejor K, matriz de confusión y métricas precision, recall y f1-score<a class="headerlink" href="#entrenamiento-del-modelo-con-el-mejor-k-matriz-de-confusion-y-metricas-precision-recall-y-f1-score" title="Link to this heading">#</a></h4>
<p>Así pues, y usando el conjunto de test anteriormente establecido para evaluar mejor el modelo, entrenamos el modelo con el mejor k, y el conjunto de entrenamiento que se estableció en primer lugar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar el mejor k según F1-score</span>
<span class="n">best_k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">df_resultados_original</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_resultados_original</span><span class="p">[</span><span class="s1">&#39;F1-score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span> <span class="s1">&#39;k&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Mejor k según F1-score: </span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Codificación one-hot</span>
<span class="n">X_trainval_enc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test_enc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_trainval_enc</span><span class="p">,</span> <span class="n">X_test_enc</span> <span class="o">=</span> <span class="n">X_trainval_enc</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">X_test_enc</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Escalado de variables numéricas reales</span>
<span class="n">cols_to_scale</span> <span class="o">=</span> <span class="n">numerical_columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X_trainval_enc</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_trainval_enc</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_trainval_enc</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">])</span>
<span class="n">X_test_enc</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_enc</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">])</span>

<span class="c1"># Convertir a arrays</span>
<span class="n">X_trainval_final</span> <span class="o">=</span> <span class="n">X_trainval_enc</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_test_final</span> <span class="o">=</span> <span class="n">X_test_enc</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Entrenar el modelo final con best_k usando trainval</span>
<span class="n">knn_final</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">best_k</span><span class="p">)</span>
<span class="n">knn_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval_final</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="c1"># Predecir en test</span>
<span class="n">y_pred_final</span> <span class="o">=</span> <span class="n">knn_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_final</span><span class="p">)</span>

<span class="c1"># Matriz de confusión</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_final</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Matriz de confusión:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>

<span class="c1"># Visualizar matriz de confusión</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No Abandona&#39;</span><span class="p">,</span> <span class="s1">&#39;Abandona&#39;</span><span class="p">],</span>
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No Abandona&#39;</span><span class="p">,</span> <span class="s1">&#39;Abandona&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Predicción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriz de Confusión (K = </span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 10. Reporte de clasificación</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Reporte de clasificación:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_final</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No Abandona&#39;</span><span class="p">,</span> <span class="s1">&#39;Abandona&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Mejor k según F1-score: 3

 Matriz de confusión:
[[707  44]
 [131 224]]
</pre></div>
</div>
<img alt="_images/a8df47664f4bc446b9fa6731eb33cacf36c50392a59cd75a5a21537c7df807b3.png" src="_images/a8df47664f4bc446b9fa6731eb33cacf36c50392a59cd75a5a21537c7df807b3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Reporte de clasificación:
              precision    recall  f1-score   support

 No Abandona       0.84      0.94      0.89       751
    Abandona       0.84      0.63      0.72       355

    accuracy                           0.84      1106
   macro avg       0.84      0.79      0.80      1106
weighted avg       0.84      0.84      0.84      1106
</pre></div>
</div>
</div>
</div>
<p>Gracias a la matriz de confusión, nos damos cuenta de que tan solo se obtuvieron 44 falsos positivos y 131 falsos negativos.</p>
<p>Además, el score dado por la métrica <code class="docutils literal notranslate"><span class="pre">f1-score</span></code> es de <code class="docutils literal notranslate"><span class="pre">0.72</span></code>, el cual es un puntaje bastante bueno, considerando 3 vecinos mas cercanos.</p>
</section>
<section id="curva-roc-y-auc">
<h4>2.1.3 Curva ROC y AUC<a class="headerlink" href="#curva-roc-y-auc" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Curva ROC y AUC ===</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">roc_auc_score</span>

<span class="c1"># Obtener probabilidades de clase positiva (abandona = 1)</span>
<span class="n">y_proba</span> <span class="o">=</span> <span class="n">knn_final</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_final</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calcular curva ROC</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">)</span>

<span class="c1"># Calcular AUC</span>
<span class="n">auc_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">)</span>

<span class="c1"># Graficar curva ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC curve (AUC = </span><span class="si">{</span><span class="n">auc_score</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aleatorio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC — KNN Clasificación&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC (Área bajo la curva ROC): </span><span class="si">{</span><span class="n">auc_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/293a7b0d7bde3c8286f67123fd5f73bf78b1ea136cb8a8dc4449e773da06ad51.png" src="_images/293a7b0d7bde3c8286f67123fd5f73bf78b1ea136cb8a8dc4449e773da06ad51.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AUC (Área bajo la curva ROC): 0.8433
</pre></div>
</div>
</div>
</div>
<p>Se ve una ROC claramente por encima de la diagonal, con AUC ≈ 0.843. Eso significa que el modelo de clasificación para “abandona / no abandona” distingue bien entre ambos: si tomas un alumno que abandona y uno que no, el modelo tiene ~84% de probabilidad de asignar mayor score al que abandona.</p>
</section>
</section>
<section id="modelo-de-regresion">
<h3>2.2 Modelo de regresión<a class="headerlink" href="#modelo-de-regresion" title="Link to this heading">#</a></h3>
<p>Para el modelo de regresión, el objetivo es predecir el índice acumulado esperado al final del semestre, por lo que debemos hacer algunos ajustes en los datos con el fin de que el modelo pueda ser entrenado correctamente.</p>
<p>Importamos algunas librerías necesarias para el modelo y su calificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">median_absolute_error</span>
</pre></div>
</div>
</div>
</div>
<p>Como queremos predecir la nota acumulada del estudiante, y solo tenemos los dos primeros semestres de su vida académica, entonces debemos promediar las notas de estos semestres:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Final_Average&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span>
    <span class="s2">&quot;Curricular units 1st sem (grade)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (grade)&quot;</span>
<span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora viene un paso muy importante, dado que queremos predecir la nota acumulada del estudiante en los dos primeros semestres, no podemos usar los datos que se encuentran en las variables correspondientes al segundo semestre, ya que existiría una fuga de datos, ya que si no se hace esto, el modelo ya tendría la información necesaria para calcular el promedio y el modelo sería perfecto, lo cual sería engañoso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols_to_exclude</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="s2">&quot;Final_Average&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (grade)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (approved)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (evaluations)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (credited)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (enrolled)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Curricular units 2nd sem (without evaluations)&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">X_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_to_exclude</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_full</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Final_Average&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Separamos ahora las columnas categóricas de las numéricas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categorical_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_full</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="n">numeric_columns_pre_ohe</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_full</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical_columns</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Y comenzamos a escoger el mejor K.</p>
<section id="id1">
<h4>2.2.1 Búsqueda del mejor K<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>En esta sección repetimos exactamente los mismos pasos que en el modelo anterior, en lo que a división de datos y procesamiento de datos se refiere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># División de los datos apartando el conjunto de test para la evaluación final del modelo</span>
<span class="n">X_trainval</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_full</span><span class="p">,</span> <span class="n">y_full</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="n">k_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">cv_results</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">}</span>

<span class="c1"># 2) Validación cruzada manual en trainval</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="c1"># División interna: train y val (80/20) aleatorio</span>
        <span class="n">X_tr</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
            <span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span>
        <span class="p">)</span>

        <span class="c1"># One-Hot encoding</span>
        <span class="n">X_tr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">X_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">X_tr</span><span class="p">,</span> <span class="n">X_val</span> <span class="o">=</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Escalado solo en las variables numéricas</span>
        <span class="n">cols_to_scale</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">numeric_columns_pre_ohe</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
        <span class="n">X_tr</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tr</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">])</span>
        <span class="n">X_val</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">[</span><span class="n">cols_to_scale</span><span class="p">])</span>

        <span class="c1"># Modelo</span>
        <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
        <span class="n">Xtr</span> <span class="o">=</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Xva</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xva</span><span class="p">)</span>

        <span class="c1"># Métricas del fold</span>
        <span class="n">mse</span>   <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">mae</span>   <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">r2</span>    <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        <span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;MAE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
        <span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

<span class="c1"># 3) Resumen por k y selección por RMSE</span>
<span class="n">summary</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">:</span>
    <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span>
        <span class="s2">&quot;RMSE_mean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;RMSE_std&quot;</span><span class="p">:</span>  <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;MAE_mean&quot;</span><span class="p">:</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;MAE&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;R2_mean&quot;</span><span class="p">:</span>   <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;R2&quot;</span><span class="p">]),</span>
    <span class="p">})</span>

<span class="n">summary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE_mean&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resumen CV 5-fold (ordenado por RMSE promedio)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">summary_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="n">best_k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">summary_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;k&quot;</span><span class="p">])</span>
<span class="n">best_rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">summary_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;RMSE_mean&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Mejor k por RMSE promedio: </span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s2"> (RMSE=</span><span class="si">{</span><span class="n">best_rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resumen CV 5-fold (ordenado por RMSE promedio)
 k  RMSE_mean  RMSE_std  MAE_mean  R2_mean
 8   1.727888  0.060486  1.066390 0.870391
10   1.728097  0.058944  1.067125 0.870467
 7   1.728986  0.060944  1.068967 0.870281
13   1.730888  0.056093  1.068793 0.870094
11   1.731144  0.056720  1.067587 0.869997
12   1.731272  0.055985  1.068855 0.869992
 9   1.731778  0.057571  1.068085 0.869913
14   1.731978  0.060444  1.073202 0.869907
15   1.734258  0.056117  1.077709 0.869583
16   1.736722  0.051798  1.078022 0.869190
17   1.740457  0.052658  1.080790 0.868624
 6   1.743966  0.068124  1.079333 0.867915
18   1.745351  0.051314  1.081949 0.867900
19   1.748179  0.054219  1.084823 0.867451
20   1.751712  0.055722  1.086759 0.866932
 5   1.756014  0.070554  1.089669 0.866034
 4   1.798718  0.076682  1.107937 0.859521
 3   1.858102  0.069552  1.132849 0.850082
 2   1.940865  0.059913  1.175126 0.836183
 1   2.196941  0.075512  1.304636 0.790072

 Mejor k por RMSE promedio: 8 (RMSE=1.7279)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Métricas en TEST</strong></p>
<ul>
<li><p><strong>RMSE</strong>: raíz del error cuadrático medio. <strong>Importancia:</strong> penaliza más los errores grandes; útil como criterio principal de selección porque refleja desviaciones altas en las predicciones, en las <strong>mismas unidades</strong> del objetivo.</p></li>
<li><p><strong>MAE</strong>: error absoluto medio. <strong>Importancia:</strong> fácil de interpretar como “error promedio esperado”; menos sensible a valores atípicos que el MSE/RMSE.</p></li>
<li><p><strong>R²</strong>: coeficiente de determinación. <strong>Importancia:</strong> indica la <strong>proporción de varianza explicada</strong> por el modelo (1 = ajuste perfecto); útil para comparar especificaciones del modelo en el mismo dataset.</p></li>
<li><p>Estas son las metricas solicitadas para el proyecto</p></li>
</ul>
</li>
</ul>
<p>Usamos el RMSE porque no solo mide el error promedio, sino que penaliza más los errores grandes, lo cual es importante ya que queremos evitar que el modelo cometa predicciones muy alejadas del valor real.</p>
</section>
<section id="entrenamiento-del-modelo-con-el-mejor-k">
<h4>2.2.2 Entrenamiento del modelo con el mejor k<a class="headerlink" href="#entrenamiento-del-modelo-con-el-mejor-k" title="Link to this heading">#</a></h4>
<p>Ahora, con el <code class="docutils literal notranslate"><span class="pre">k</span></code> encontrado, construimos el modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- One-Hot Encoding en trainval y test</span>
<span class="n">X_trainval_ohe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">X_test_ohe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">X_test_ohe</span> <span class="o">=</span> <span class="n">X_test_ohe</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">X_trainval_ohe</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># --- Escalado de numéricas (ajustado SOLO en trainval)</span>
<span class="n">cols_to_scale_final</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">numeric_columns_pre_ohe</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_trainval_ohe</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">scaler_final</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_trainval_ohe</span><span class="p">[</span><span class="n">cols_to_scale_final</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_final</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_trainval_ohe</span><span class="p">[</span><span class="n">cols_to_scale_final</span><span class="p">])</span>
<span class="n">X_test_ohe</span><span class="p">[</span><span class="n">cols_to_scale_final</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_final</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_ohe</span><span class="p">[</span><span class="n">cols_to_scale_final</span><span class="p">])</span>

<span class="c1"># --- Entrenar modelo final y predecir en test</span>
<span class="n">knn_final</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">best_k</span><span class="p">)</span>
<span class="n">knn_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval_ohe</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>
<span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">knn_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_ohe</span><span class="p">)</span>

<span class="c1"># --- Métricas en TEST </span>
<span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
<span class="n">rmse_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_test</span><span class="p">)</span>
<span class="n">mae_test</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
<span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== Métricas en TEST =====&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE:    </span><span class="si">{</span><span class="n">rmse_test</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE:     </span><span class="si">{</span><span class="n">mae_test</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R²:      </span><span class="si">{</span><span class="n">r2_test</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== Métricas en TEST =====
RMSE:    1.7160
MAE:     1.0452
R²:      0.8722
</pre></div>
</div>
</div>
</div>
<p>Para la métrica RMSE, conseguimos un valor de 1.716, usando un <code class="docutils literal notranslate"><span class="pre">k=8</span></code></p>
</section>
<section id="grafico-predicho-vs-real">
<h4>2.2.3 Gráfico predicho vs real<a class="headerlink" href="#grafico-predicho-vs-real" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1) Gráfico Real vs Predicho (holdout)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">y_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
         <span class="p">[</span><span class="n">y_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Valor real&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Valor predicho&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Real vs Predicho (k=</span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s2">) &quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 2) Distribución de errores (residuos) en holdout</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_test</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot; Distribución de errores (residuos) &quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Error (real - predicho)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 3) Distribución del error absoluto en holdout</span>
<span class="n">abs_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">abs_errors</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot; Distribución del error absoluto &quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;|Error|&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/20d34f9cbe1e4f5def51c05c6056eabd798f53fed53569e0738b107da7eb902b.png" src="_images/20d34f9cbe1e4f5def51c05c6056eabd798f53fed53569e0738b107da7eb902b.png" />
<img alt="_images/854b7c9186a6830c2a1224cdc4bdb1d847ea62da7461deb985cf2d47e365f389.png" src="_images/854b7c9186a6830c2a1224cdc4bdb1d847ea62da7461deb985cf2d47e365f389.png" />
<img alt="_images/ff507816569c0928cb6338ba7904a7efc4f8440c5cb624d274beeb4509468db0.png" src="_images/ff507816569c0928cb6338ba7904a7efc4f8440c5cb624d274beeb4509468db0.png" />
</div>
</div>
<p>¿Cómo interpretamos esto?</p>
<p><strong>1) Real vs. Predicho</strong><br />
La nube de puntos cae bastante cerca de la diagonal roja (que sería la predicción perfecta), así que el modelo está bien calibrado en general. En los valores muy bajos hay más dispersión: a veces el modelo predice un poco por encima de lo real (sobre-predice cerca de 0).</p>
<p><strong>2) Histograma de residuos (real − predicho)</strong><br />
La distribución se centra alrededor de 0, lo cual significa que <strong>no hay un sesgo fuerte</strong>: no vive sobre- ni sub-prediciendo de forma sistemática. Hay una cola hacia la derecha (algunos casos con real &gt; predicho), o sea <strong>sub-predicción</strong> en pocos puntos, y aparecen algunos errores grandes pero muy pocos.</p>
<p><strong>3) Histograma del error absoluto |error|</strong><br />
La mayor parte de las observaciones tiene <strong>errores pequeños</strong> y una cola larga de pocos casos con errores altos. Esto cuadra con las métricas: <strong>MAE ≈ 1.05</strong> (error promedio bajo) y <strong>RMSE &gt; MAE</strong> (unos pocos errores grandes elevan el RMSE).</p>
<p><strong>En resumen:</strong> Las tres gráficas cuentan la misma historia: <strong>buen ajuste general</strong>, con algunos casos difíciles en los extremos.</p>
</section>
</section>
</section>
<section id="conclusiones">
<h2>3. Conclusiones<a class="headerlink" href="#conclusiones" title="Link to this heading">#</a></h2>
<p>Aunque en lo personal pensamos que es un poco díficil comparar ambos modelos ya que no son del mismo tipo, ambos nos ofrecen soluciones distintas al mismo problema, ya que si bien el de clasificación es quien nos dice si un estudiante abandona o no, con el de regresión nos podemos dar una idea de esto gracias a la nota que logró dicho estudiante.</p>
<p>En el caso del modelo de clasificación el valor de <code class="docutils literal notranslate"><span class="pre">k</span></code> que mejor resultado dió fue de 3, considerando la métrica f1-score, mientras que en el de regresión fue de 8 considerando la métrica RMSE.</p>
<p>Por último, una reflexión que podemos obtener sobre el modelo K-nn al hacer este proyecto, es que, si bien una de sus ventajas es que es el más simple de entender, ya que se basa netamente en qué tan alejado estan los registros para predecir, sentimos que podría tener limitaciones en el mundo real, ya que por ejemplo, al basarse en distancias, siempre tenemos que estandarizar y codificar variables despues de cada split para evitar el data leakage, lo cual conlleva a un costo computacional alto.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Análisis Exploratorio de Datos</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indice">Índice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-datos-eda">1. Análisis Exploratorio de Datos (EDA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-los-datos">1.1 Carga de los datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primer-vistazo-a-los-datos">1.2 Primer vistazo a los datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-datos">1.3. Análisis de los datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-las-variables-numericas">1.4 Resumen de las variables numéricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-la-variable-objetivo">1.5 Distribución de la variable objetivo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-las-categoricas-vs-el-target">1.6 Análisis de las categóricas vs el target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-las-variables-numericas">1.7 Visualización de las variables numéricas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histogramas">1.7.1 Histogramas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot-y-deteccion-de-outliers">1.7.2 Boxplot y detección de outliers</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion">1.8 Matriz de correlación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-analisis-exploratorio-de-datos-eda">1.9 Conclusión del Análisis exploratorio de datos (EDA)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-k-nn">2. Modelo K-nn</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-clasificacion-binaria">2.1 Modelo de clasificación binaria</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#busqueda-del-mejor-k">2.1.1 Búsqueda del mejor K</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-del-modelo-con-el-mejor-k-matriz-de-confusion-y-metricas-precision-recall-y-f1-score">2.1.2 Entrenamiento del modelo con el mejor K, matriz de confusión y métricas precision, recall y f1-score</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#curva-roc-y-auc">2.1.3 Curva ROC y AUC</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion">2.2 Modelo de regresión</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.2.1 Búsqueda del mejor K</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-del-modelo-con-el-mejor-k">2.2.2 Entrenamiento del modelo con el mejor k</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-predicho-vs-real">2.2.3 Gráfico predicho vs real</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">3. Conclusiones</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johan Díaz, Héctor Sanjuan, Miguel Lugo, Luis D. Peñaranda
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>